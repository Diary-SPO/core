var e=Object.defineProperty,r=Object.defineProperties,s=Object.getOwnPropertyDescriptors,t=Object.getOwnPropertySymbols,o=Object.prototype.hasOwnProperty,a=Object.prototype.propertyIsEnumerable,n=(r,s,t)=>s in r?e(r,s,{enumerable:!0,configurable:!0,writable:!0,value:t}):r[s]=t,l=(e,r)=>{for(var s in r||(r={}))o.call(r,s)&&n(e,s,r[s]);if(t)for(var s of t(r))a.call(r,s)&&n(e,s,r[s]);return e},i=(e,r)=>{var s={};for(var n in e)o.call(e,n)&&r.indexOf(n)<0&&(s[n]=e[n]);if(null!=e&&t)for(var n of t(e))r.indexOf(n)<0&&a.call(e,n)&&(s[n]=e[n]);return s};import{y as c,t as f,c as u,R as h,v as p,x as _,z as v,C as d,J as m,h as g,K as P,T as b,N as x,O as y,Q as j,U as O,W as R,X as w,Y as T,Z as k}from"./index-XyJYIhAT.js";const N="_PullToRefresh_1e1jl_1",M="_PullToRefresh--refreshing_1e1jl_5",W="_PullToRefresh__controls_1e1jl_10",D="_PullToRefresh--ios_1e1jl_15",E="_PullToRefresh__spinner_1e1jl_19",Y="_PullToRefresh--watching_1e1jl_42",$="_PullToRefresh__spinner-self_1e1jl_46",S="_PullToRefresh__spinner-path_1e1jl_54",z="_PullToRefresh__spinner--on_1e1jl_65",I="_PullToRefresh__content_1e1jl_69";const L=e=>{var r=e,{on:s=!0,size:t=24,strokeWidth:o=2.5,progress:a=0,children:n="Пожалуйста, подождите..."}=r,p=i(r,["on","size","strokeWidth","progress","children"]);const _=.5*t-.5*o,v=2*Math.PI*_,d=.5*t,m=function(e,r){const s=e/100;return 2*Math.PI*r*(1-s)}(s?80:a,_);return c(h,l({baseClassName:u(E,s&&z)},p),s&&c(f,null,n),c("svg",{role:"presentation",className:$,style:{width:t,height:t},viewBox:`0 0 ${t} ${t}`,xmlns:"http://www.w3.org/2000/svg"},c("g",{style:{width:t,height:t,transformOrigin:`${d}px ${d}px`}},c("circle",{className:S,fill:"none",strokeDasharray:v,strokeDashoffset:m,strokeWidth:o,strokeLinecap:"round",cx:d,cy:d,r:_}))))};function C(e){if(!e)return!1;for(;e.originalEvent;)e=e.originalEvent;return e.preventDefault&&e.cancelable&&e.preventDefault(),e.stopPropagation&&e.stopPropagation(),!1}const F={cancelable:!0,passive:!1},B=e=>{var t=e,{children:o,isFetching:a,onRefresh:n,className:f}=t,h=i(t,["children","isFetching","onRefresh","className"]);const E=p(),$=_(),{document:S}=v(),z=d(a),B=m((()=>({start:"ios"===E?-10:-45,max:"ios"===E?50:80,maxY:"ios"===E?400:80,refreshing:"ios"===E?36:50,positionMultiplier:"ios"===E?.21:1})),[E]),[J,K]=g(B.start),[Q,U]=g(!1),[X,Z]=g(!1),[q,A]=g(!1),[G,H]=g(!1),V=d(G),ee=P(0),[re,se]=g(0),[te,oe]=g(0),ae=b((()=>{U(!1),A(!1),Z(!1),K(B.start),oe(0),se(0)}),[B]),ne=b((()=>{G||ae()}),[G,ae]),{set:le,clear:ie}=x(ne,1e3);y((()=>{void 0!==z&&z&&!a&&ne()}),[z,a,ne]),y((()=>{void 0!==z&&!z&&a&&ie()}),[a,z,ie]);const ce=b((()=>{!X&&n&&(le(),Z(!0),K((e=>"ios"===E?e:B.refreshing)),n())}),[X,n,le,E,B.refreshing]);y((()=>{void 0!==V&&V&&!G&&(!X&&q?ce():X&&!a?ae():(K(X?B.refreshing:B.start),oe(0),se(0)))}),[B,z,a,ne,V,G,X,q,ce]);const fe=P(0);j(S,"touchmove",(e=>{(e=>{if(Q||X)return!0;const r=k(e)-fe.current;return 0===(null==$?void 0:$.getScroll().y)&&r>0&&G})(e)&&(e.preventDefault(),e.stopPropagation())}),F);const ue=`translate3d(0, ${J}px, 0)`;let he="";return"ios"===E&&X&&!G?he="translate3d(0, 100px, 0)":"ios"===E&&(re||X)&&(he=`translate3d(0, ${re}px, 0)`),c(w.Provider,{value:!0},c(O,(pe=l({"aria-live":"polite","aria-busy":!!a},h),_e={onStart:e=>{X&&C(e),H(!0),fe.current=e.startY,S&&S.documentElement.classList.add("vkui--disable-overscroll-behavior")},onMove:e=>{const{isY:r,shiftY:s}=e,{start:t,max:o}=B,a=null==$?void 0:$.getScroll().y;if(Q&&G){C(e);const{positionMultiplier:r,maxY:a}=B,n=Math.max(0,s-ee.current),l=T(t+n*r,t,a),i=l>-10?80*Math.abs((l+10)/o):0;K(l),oe(T(i,0,80)),A(i>80),se(2.3*(l+10)),i>85&&!X&&"ios"===E&&ce()}else r&&0===a&&s>0&&!X&&G&&(C(e),ee.current=s,U(!0),K(t),oe(0))},onEnd:()=>{U(!1),H(!1),S&&S.documentElement.classList.remove("vkui--disable-overscroll-behavior")},className:u(N,"ios"===E&&D,Q&&Y,X&&M,f)},r(pe,s(_e))),c(R,{className:W,useParentWidth:!0},c(L,{style:{transform:ue,WebkitTransform:ue,opacity:Q||X||q?1:0},on:X,progress:X?void 0:te})),c("div",{className:I,style:{transform:he,WebkitTransform:he}},o)));var pe,_e};export{B as P};
