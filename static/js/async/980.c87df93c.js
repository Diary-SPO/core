"use strict";(self.webpackChunk_diary_spo_web=self.webpackChunk_diary_spo_web||[]).push([["980"],{583:function(e,t,l){l.r(t),l.d(t,{default:()=>y});var o=l("2322");let a=async e=>{let t=new TextEncoder().encode(e);return Array.from(new Uint8Array(await crypto.subtle.digest("SHA-256",t))).map(e=>String.fromCharCode(e)).join("")},r=async e=>btoa(await a(e));var n=l("5147"),i=(0,l("7052").De)("Icon28DoorArrowLeftOutline","door_arrow_left_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="door_arrow_left_outline_28"><path fill="currentColor" fill-rule="evenodd" d="M17.643 25H15a1 1 0 1 1 0-2h2.6c1.137 0 1.929 0 2.546-.051.605-.05.953-.142 1.216-.276a3 3 0 0 0 1.311-1.311c.134-.263.226-.611.276-1.216.05-.617.051-1.41.051-2.546v-7.2c0-1.137 0-1.929-.051-2.546-.05-.605-.142-.953-.276-1.216a3 3 0 0 0-1.311-1.311c-.263-.134-.611-.226-1.216-.276C19.529 5.001 18.736 5 17.6 5H15a1 1 0 1 1 0-2h2.643c1.084 0 1.958 0 2.666.058.729.06 1.369.185 1.961.487a5 5 0 0 1 2.185 2.185c.302.592.428 1.233.487 1.961C25 8.4 25 9.273 25 10.357v7.286c0 1.084 0 1.958-.058 2.666-.06.728-.185 1.369-.487 1.961a5 5 0 0 1-2.185 2.185c-.592.302-1.232.428-1.961.487C19.6 25 18.727 25 17.643 25M3 14a1 1 0 0 1 1-1h9.586l-2.293-2.293a1 1 0 0 1 1.414-1.414l4 4 .007.007a1 1 0 0 1 .286.697v.006c0 .272-.11.518-.286.698l-.008.007-3.999 4a1 1 0 0 1-1.414-1.415L13.586 15H4a1 1 0 0 1-1-1" clip-rule="evenodd" /></symbol>',28,28,!1,void 0),s=l("7694"),c=l("387"),u=l("2784"),d=l("1029"),f=l("3292"),h=l("831"),m=l("8143"),v=l("128"),b=l("2861");let g=e=>{var t,l;let o=String(e.id),a=e.token,r="".concat(String(e.lastName)," ").concat(String(e.firstName)," ").concat(String(e.middleName)),n=String(null===(t=e.organization)||void 0===t?void 0:t.abbreviation),i=String(null===(l=e.organization)||void 0===l?void 0:l.addressSettlement),s=String(null==e?void 0:e.groupName);localStorage.setItem("id",o),localStorage.setItem("token",a);(0,b.o4)(a),localStorage.setItem("data",JSON.stringify({name:r,org:n,city:i,group:s}))},p=/^[a-zA-Z0-9а-яА-ЯёЁ-]+$/,y=e=>{let{id:t}=e,l=(0,s.fB)(),[a,y]=(0,u.useState)(""),[w,x]=(0,u.useState)(""),[S,_]=(0,u.useState)(!1),[C,j]=(0,u.useState)(!1),[k,I]=(0,v.D)();(0,u.useLayoutEffect)(()=>{(async()=>{if(j(!0),!(localStorage.getItem("token")||(0,b.LP)())){I({before:(0,o.jsx)(n.y,{fill:m.h7}),subtitle:"Заполни форму и войди в дневник",title:"О вас нет данных, ты кто такой?"}),j(!1);return}j(!1),await l.replace("/".concat(d.nZ))})()},[]);let A=e=>{let{name:t,value:l}=e.currentTarget,o={login:y,password:x}[t];_(!1),j(!1),null==o||o(l)},z=async e=>{if(j(!0),e.preventDefault(),!p.test(a)){_(!0);return}let t=await r(w);try{let e=await (0,h.SV)(a,t,!0),{data:o}=(0,f._y)(e,()=>_(!0),void 0,j,I,!1,!0);if((0,f.k0)(o)||!o.token)return;g(o),I({title:"Вхожу",subtitle:"Подождите немного"}),await l.replace("/".concat(d.nZ))}catch(e){console.error(e)}finally{j(!1)}},D=""===a,L=""===w,B=w&&!L,N=D?"Логин":p.test(a)?"Логин введён":"Введите корректный логин",H=""===w?"Пароль":B?"Пароль введён":"Введите корректный пароль",J=S?(0,o.jsx)(c.PXv,{header:"Некорректные данные",mode:"error",children:"Проверьте правильность логина и пароля"}):(0,o.jsx)(c.PXv,{header:"Нам можно доверять",mode:"default",children:"Мы бережно передаем ваши данные и храним в зашифрованном виде"}),M=D?"default":p.test(a)?"valid":"error",Z=!w||!a||!p.test(a)||C;return(0,o.jsxs)(c.s_4,{nav:t,children:[(0,o.jsx)(f.Q9,{title:"Авторизация"}),(0,o.jsxs)(c.ZAu,{children:[J,(0,o.jsxs)("form",{method:"post",onSubmit:z,children:[(0,o.jsx)(c.xJW,{required:!0,htmlFor:"userLogin",top:"Логин",status:M,bottom:D||N,bottomId:"login-type",children:(0,o.jsx)(c.IIB,{required:!0,"aria-labelledby":"login-type",id:"userLogin",type:"text",name:"login",placeholder:"Введите логин",value:a,onChange:A})}),(0,o.jsx)(c.xJW,{top:"Пароль",htmlFor:"pass",status:L?"default":B?"valid":"error",bottom:L||H,children:(0,o.jsx)(c.IIB,{name:"password",id:"pass",type:"password",placeholder:"Введите пароль",onChange:A})}),(0,o.jsx)(c.xJW,{children:(0,o.jsx)(c.zxk,{type:"submit",size:"l",stretched:!0,onClick:z,disabled:Z,before:(0,o.jsx)(i,{}),children:C?"Пытаюсь войти...":"Войти"})})]}),k]})]})}},128:function(e,t,l){l.d(t,{V:()=>s,D:()=>u});var o=l("2322"),a=l("5147"),r=l("387"),n=l("2784"),i=l("8143");let s=()=>{let[e,t]=(0,n.useState)(null);return[e,(0,n.useCallback)(()=>{t((0,o.jsx)(r.A9Q,{layout:"vertical",onClose:()=>t(null),before:(0,o.jsx)(a.y,{fill:i.h7}),subtitle:"Вы временно заблокированы. Если вы считаете, что это ошибка, то сообщите нам",children:"Слишком частые запросы"}))},[])]};var c=(0,l("7052").De)("Icon28InfoCircleOutline","info_circle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="info_circle_outline_28"><path fill="currentColor" d="M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 2C8.477 4 4 8.477 4 14s4.477 10 10 10 10-4.477 10-10S19.523 4 14 4m.074 8c.237 0 .386.037.517.107q.196.106.302.302c.07.13.107.28.107.517v6.148c0 .237-.037.386-.107.517a.73.73 0 0 1-.302.302c-.13.07-.28.107-.517.107h-.148c-.237 0-.386-.037-.517-.107a.73.73 0 0 1-.302-.302c-.07-.13-.107-.28-.107-.517v-6.148c0-.237.037-.386.107-.517a.73.73 0 0 1 .302-.302c.13-.07.28-.107.517-.107zM14 7.6a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8" /></symbol>',28,28,!1,void 0);let u=()=>{let[e,t]=(0,n.useState)(null);return[e,(0,n.useCallback)(e=>e?(t((0,o.jsx)(r.A9Q,{layout:e.layout||"vertical",onClose:()=>t(null),before:e.before||(0,o.jsx)(c,{fill:i.zK}),offsetY:50,action:e.action,onActionClick:e.onActionClick,duration:e.duration,style:e.style,subtitle:e.subtitle,children:e.title})),null):(t(null),null),[])]}}}]);