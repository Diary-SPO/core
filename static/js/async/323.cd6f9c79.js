"use strict";(self.webpackChunk_diary_spo_web=self.webpackChunk_diary_spo_web||[]).push([["323"],{3081:function(e,l,t){t.r(l),t.d(l,{default:()=>z});var a=t("2322"),r=t("7052"),i=(0,r.De)("Icon28InfoCircle","info_circle_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="info_circle_28"><path fill-rule="evenodd" d="M14 26c6.627 0 12-5.373 12-12S20.627 2 14 2 2 7.373 2 14s5.373 12 12 12m0-6a1 1 0 0 1-1-1v-6a1 1 0 1 1 2 0v6a1 1 0 0 1-1 1m0-9.8-.123-.006A1.2 1.2 0 0 1 14 7.8l.123.006A1.2 1.2 0 0 1 14 10.2" clip-rule="evenodd" /></symbol>',28,28,!1,void 0),n=t("5147"),o=t("2277"),s=t("2784"),c=t("3292"),u=(0,r.De)("Icon28UserCircleOutline","user_circle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="user_circle_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 18.5c-2.086 0-4.08.582-5.797 1.649A9.95 9.95 0 0 0 14 24c2.16 0 4.161-.685 5.796-1.85A10.94 10.94 0 0 0 14 20.5M14 4C8.477 4 4 8.477 4 14a9.96 9.96 0 0 0 2.648 6.779A12.93 12.93 0 0 1 14 18.5c2.67 0 5.215.808 7.353 2.277A9.96 9.96 0 0 0 24 14c0-5.523-4.477-10-10-10m0 3.5a4.75 4.75 0 0 1 4.75 4.75A4.75 4.75 0 0 1 14 17a4.75 4.75 0 0 1-4.75-4.75A4.75 4.75 0 0 1 14 7.5m0 2c-1.52 0-2.75 1.23-2.75 2.75S12.48 15 14 15s2.75-1.23 2.75-2.75S15.52 9.5 14 9.5" /></g></symbol>',28,28,!1,void 0),d=(0,r.De)("Icon28GridSquareOutline","grid_square_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" viewBox="0 0 28 28" id="grid_square_outline_28"><g fill="none" fill-rule="evenodd"><path d="M0 0h28v28H0z" /><path fill="currentColor" fill-rule="nonzero" d="m10.41 3 7.516.002c1.958.02 2.954.231 3.988.784a5.54 5.54 0 0 1 2.3 2.3c.583 1.091.786 2.14.786 4.324l-.002 7.516c-.02 1.958-.231 2.954-.784 3.988a5.54 5.54 0 0 1-2.3 2.3c-1.091.583-2.14.786-4.324.786l-7.516-.002c-1.958-.02-2.954-.231-3.988-.784a5.54 5.54 0 0 1-2.3-2.3C3.203 20.823 3 19.774 3 17.59l.002-7.516c.02-1.958.231-2.954.784-3.988a5.54 5.54 0 0 1 2.3-2.3C7.177 3.203 8.226 3 10.41 3m7.18 2h-7.18c-1.881 0-2.62.142-3.38.55-.641.342-1.138.839-1.48 1.48-.365.68-.517 1.343-.545 2.822L5 10.41v7.18c0 1.881.142 2.62.55 3.38.342.641.839 1.138 1.48 1.48.68.365 1.343.517 2.822.545l.558.005h7.18c1.881 0 2.62-.142 3.38-.55a3.54 3.54 0 0 0 1.48-1.48c.365-.68.517-1.343.545-2.822L23 17.59v-7.18c0-1.881-.142-2.62-.55-3.38a3.54 3.54 0 0 0-1.48-1.48c-.68-.365-1.343-.517-2.822-.545zM12 17.5a1 1 0 0 1 .117 1.993L12 19.5H9a1 1 0 0 1-.117-1.993L9 17.5zm7 0a1 1 0 0 1 .117 1.993L19 19.5h-3a1 1 0 0 1-.117-1.993L16 17.5zM12 13a1 1 0 0 1 .117 1.993L12 15H9a1 1 0 0 1-.117-1.993L9 13zm7 0a1 1 0 0 1 .117 1.993L19 15h-3a1 1 0 0 1-.117-1.993L16 13zm0-4.5a1 1 0 0 1 .117 1.993L19 10.5h-3a1 1 0 0 1-.117-1.993L16 8.5zm-7 0a1 1 0 0 1 .117 1.993L12 10.5H9a1 1 0 0 1-.117-1.993L9 8.5z" /></g></symbol>',28,28,!1,void 0),h=(0,r.De)("Icon28EducationOutline","education_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="education_outline_28"><path fill-rule="evenodd" d="M13.036 3.249a2 2 0 0 1 1.928 0l9.995 5.499A2.02 2.02 0 0 1 26 10.5V18a1 1 0 1 1-2 0v-5.22l-2 1.1v3.161c0 .425 0 .685-.014.912a7.5 7.5 0 0 1-7.033 7.033c-.317.02-.636.014-.953.014s-.636.006-.953-.014a7.5 7.5 0 0 1-7.033-7.033A16 16 0 0 1 6 17.04v-3.157l-2.967-1.631c-1.383-.76-1.383-2.746 0-3.506zM8 14.983V17c0 .479 0 .674.01.832a5.5 5.5 0 0 0 5.158 5.158c.158.01.353.01.832.01s.674 0 .832-.01a5.5 5.5 0 0 0 5.158-5.158c.01-.158.01-.353.01-.832v-2.02l-5.036 2.771a2 2 0 0 1-1.928 0zm6-9.982L3.996 10.5 14 15.999l9.995-5.499z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0),m=(0,r.De)("Icon28TextViewfinderOutline","text_viewfinder_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="currentColor" viewBox="0 0 28 28" id="text_viewfinder_outline_28"><path fill-rule="evenodd" d="M7 5a2 2 0 0 0-2 2v1a1 1 0 1 1-2 0V7a4 4 0 0 1 4-4h1a1 1 0 1 1 0 2zm1 4a1 1 0 0 1 1-1h10a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1m0 10a1 1 0 0 1 1-1h6a1 1 0 1 1 0 2H9a1 1 0 0 1-1-1m1-6a1 1 0 1 0 0 2h10a1 1 0 1 0 0-2zm12-8a2 2 0 0 1 2 2v1a1 1 0 1 0 2 0V7a4 4 0 0 0-4-4h-1a1 1 0 1 0 0 2zm0 18a2 2 0 0 0 2-2v-1a1 1 0 1 1 2 0v1a4 4 0 0 1-4 4h-1a1 1 0 1 1 0-2zM7 23a2 2 0 0 1-2-2v-1a1 1 0 1 0-2 0v1a4 4 0 0 0 4 4h1a1 1 0 1 0 0-2z" clip-rule="evenodd" /></symbol>',28,28,!1,void 0);let v=[{icon:(0,a.jsx)(u,{}),type:"summary",text:"Общее"},{icon:(0,a.jsx)(d,{}),type:"current",text:"Текущие"},{icon:(0,a.jsx)(h,{}),type:"finalMarks",text:"Итоговые"},{icon:(0,a.jsx)(m,{}),type:"attestation",text:"Ведомость"}];var f=t("9344");let y=e=>{let l=e.daysWithMarksForSubject.reduce((e,l)=>{if(l.daysWithMarks)for(let t of l.daysWithMarks)e.push(...t.markValues);return e},[]),t=l.length,a=l.reduce((e,l)=>e+Number(f.GR[l]),0),r={2:0,3:0,4:0,5:0};for(let e of l){let l=Number(f.GR[e]);l>=2&&l<=5&&(r[l]+=1)}return{totalNumberOfMarks:t,averageMark:Number((a/t).toFixed(3)),markCounts:r}};var x=t("831"),b=t("8143"),w=t("128"),_=t("490");let g=e=>{let{text:l}=e;return(0,a.jsx)(o.ZAu,{header:(0,a.jsx)(o.h4i,{mode:"tertiary",children:null!=l?l:"Загрузка..."}),children:(0,a.jsx)(o.ZCY,{children:(0,a.jsx)(o.$jN,{})})})},p=(0,s.lazy)(()=>t.e("274").then(t.bind(t,5639))),j=(0,s.lazy)(()=>t.e("5").then(t.bind(t,547))),k=(0,s.lazy)(()=>t.e("657").then(t.bind(t,5423))),M=(0,s.lazy)(()=>t.e("449").then(t.bind(t,7601))),S=(e,l,t,r,i,n,o,s)=>{switch(e){case"summary":return(0,a.jsx)(p,{totalNumberOfMarks:l,averageMark:t,markCounts:r});case"current":return(0,a.jsx)(k,{marksForSubject:i});case"finalMarks":return(0,a.jsx)(j,{setIsError:n,isLoading:o,setIsLoading:s});case"attestation":return(0,a.jsx)(M,{setIsError:n,isLoading:o,setIsLoading:s});default:return null}},z=e=>{let{id:l}=e,[t,r]=(0,s.useState)(!1),[u,d]=(0,s.useState)(!1),[h,m]=(0,w.D)(),[f,p]=(0,w.V)(),[j,k]=(0,s.useState)(null),[M,z]=(0,s.useState)(null),[C,L]=(0,s.useState)(null),[A,I]=(0,s.useState)(null),D=e=>{if(!!e.daysWithMarksForSubject.length)O(e),k(e),localStorage.setItem("lastMarksFetchTime",String(Date.now())),localStorage.setItem("savedMarks",JSON.stringify(e))},O=e=>{let l=y(e);z(l.totalNumberOfMarks),L(l.averageMark),I(l.markCounts)},F=async e=>{let l=localStorage.getItem("savedMarks");if(l&&!(0,c.yy)("lastMarksFetchTime")&&!e){let e=JSON.parse(l);m({title:"Оценки взяты из кеша",onActionClick:()=>F(!0),action:"Загрузить новые",before:(0,a.jsx)(i,{fill:b.zK})}),D(e);return}try{d(!1),r(!0);let{data:e}=await (0,x.r)();if((0,c._y)(e,()=>{m({before:(0,a.jsx)(n.y,{fill:b.h7}),title:"Ошибка при попытке загрузить оценки",action:"Попробовать снова",onActionClick:()=>F(!0)})},p,r,m,!1),(0,c.k0)(e)||!("daysWithMarksForSubject"in e)){localStorage.removeItem("savedMarks");return}D(e)}catch{d(!0)}finally{r(!1)}};(0,s.useEffect)(()=>{F()},[]);let[N,V]=(0,s.useState)("summary"),H=S(N,M,C,A,j,d,t,r);return console.log("activeTab",H),(0,a.jsxs)(o.s_4,{nav:l,children:[(0,a.jsx)(_.Q9,{title:"Успеваемость"}),(0,a.jsxs)(o.t8j,{onRefresh:()=>F(!0),isFetching:t,children:[(0,a.jsx)(o.mQc,{mode:"default",children:(0,a.jsx)(o.Z66,{arrowSize:"l",children:v.map(e=>(0,a.jsx)(o.LM1,{"aria-controls":e.type,id:e.type,before:e.icon,disabled:N===e.type,selected:N===e.type,onClick:()=>V(e.type),children:e.text},e.type))})}),t&&(0,a.jsx)(g,{})]}),!t&&!u&&(0,a.jsx)(_.n4,{id:"tab",children:H}),u&&(0,a.jsx)(_._x,{}),h,f]})}},128:function(e,l,t){t.d(l,{V:()=>s,D:()=>u});var a=t("2322"),r=t("5147"),i=t("2277"),n=t("2784"),o=t("8143");let s=()=>{let[e,l]=(0,n.useState)(null);return[e,(0,n.useCallback)(()=>{l((0,a.jsx)(i.A9Q,{layout:"vertical",onClose:()=>l(null),before:(0,a.jsx)(r.y,{fill:o.h7}),subtitle:"Вы временно заблокированы. Если вы считаете, что это ошибка, то сообщите нам",children:"Слишком частые запросы"}))},[])]};var c=(0,t("7052").De)("Icon28InfoCircleOutline","info_circle_outline_28","0 0 28 28",'<symbol xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 28 28" id="info_circle_outline_28"><path fill="currentColor" d="M14 2c6.627 0 12 5.373 12 12s-5.373 12-12 12S2 20.627 2 14 7.373 2 14 2m0 2C8.477 4 4 8.477 4 14s4.477 10 10 10 10-4.477 10-10S19.523 4 14 4m.074 8c.237 0 .386.037.517.107q.196.106.302.302c.07.13.107.28.107.517v6.148c0 .237-.037.386-.107.517a.73.73 0 0 1-.302.302c-.13.07-.28.107-.517.107h-.148c-.237 0-.386-.037-.517-.107a.73.73 0 0 1-.302-.302c-.07-.13-.107-.28-.107-.517v-6.148c0-.237.037-.386.107-.517a.73.73 0 0 1 .302-.302c.13-.07.28-.107.517-.107zM14 7.6a1.4 1.4 0 1 1 0 2.8 1.4 1.4 0 0 1 0-2.8" /></symbol>',28,28,!1,void 0);let u=()=>{let[e,l]=(0,n.useState)(null);return[e,(0,n.useCallback)(e=>e?(l((0,a.jsx)(i.A9Q,{layout:e.layout||"vertical",onClose:()=>l(null),before:e.before||(0,a.jsx)(c,{fill:o.zK}),offsetY:50,action:e.action,onActionClick:e.onActionClick,duration:e.duration,style:e.style,subtitle:e.subtitle,children:e.title})),null):(l(null),null),[])]}}}]);